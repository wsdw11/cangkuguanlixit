# ğŸš€ ä»“åº“ç®¡ç†ç³»ç»Ÿ - äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šLinuxï¼ˆæ¨è Ubuntu 20.04+ æˆ– CentOS 7+ï¼‰
- **å†…å­˜**ï¼šè‡³å°‘ 1GBï¼ˆæ¨è 2GB+ï¼‰
- **CPU**ï¼š1æ ¸ä»¥ä¸Š
- **ç¡¬ç›˜**ï¼šè‡³å°‘ 10GB å¯ç”¨ç©ºé—´

### 2. éœ€è¦å®‰è£…çš„è½¯ä»¶
- Node.js 16+ 
- npm æˆ– yarn
- PM2ï¼ˆè¿›ç¨‹ç®¡ç†å·¥å…·ï¼‰
- Nginxï¼ˆWebæœåŠ¡å™¨ï¼Œå¯é€‰ï¼‰

---

## ğŸ”§ ç¬¬ä¸€æ­¥ï¼šè¿æ¥æœåŠ¡å™¨

### ä½¿ç”¨ SSH è¿æ¥
```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
# æˆ–
ssh ç”¨æˆ·å@ä½ çš„æœåŠ¡å™¨IP
```

### ä½¿ç”¨ FTP/SFTP å·¥å…·
- Windows: WinSCP, FileZilla
- Mac: Cyberduck, Transmit

---

## ğŸ“¦ ç¬¬äºŒæ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šå®‰è£… Node.js

### Ubuntu/Debian ç³»ç»Ÿ
```bash
# æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨
sudo apt update

# å®‰è£… Node.js 18.x
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

### CentOS/RHEL ç³»ç»Ÿ
```bash
# å®‰è£… Node.js 18.x
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

### å¦‚æœä¸‹è½½æ…¢ï¼Œä½¿ç”¨å›½å†…é•œåƒ
```bash
# ä½¿ç”¨æ·˜å®é•œåƒ
npm config set registry https://registry.npmmirror.com
```

---

## ğŸ“¤ ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨

### æ–¹æ³•1ï¼šä½¿ç”¨ Gitï¼ˆæ¨èï¼‰
```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /opt
git clone ä½ çš„ä»“åº“åœ°å€ warehouse-management
cd warehouse-management
```

### æ–¹æ³•2ï¼šä½¿ç”¨ FTP/SFTP
1. å°†æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹å‹ç¼©æˆ zip
2. ä½¿ç”¨ FTP å·¥å…·ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå¦‚ `/opt/warehouse-management`ï¼‰
3. åœ¨æœåŠ¡å™¨ä¸Šè§£å‹ï¼š
```bash
cd /opt
unzip warehouse-management.zip
cd warehouse-management
```

### æ–¹æ³•3ï¼šä½¿ç”¨ scp å‘½ä»¤
```bash
# åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œ
scp -r ./warehouse-management root@æœåŠ¡å™¨IP:/opt/
```

---

## ğŸ”¨ ç¬¬å››æ­¥ï¼šå®‰è£…é¡¹ç›®ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/warehouse-management

# å®‰è£…åç«¯ä¾èµ–
cd backend
npm install --production

# å®‰è£…å‰ç«¯ä¾èµ–
cd ../frontend
npm install

# æ„å»ºå‰ç«¯ï¼ˆç”Ÿæˆç”Ÿäº§ç‰ˆæœ¬ï¼‰
npm run build
```

---

## âš™ï¸ ç¬¬äº”æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
# è¿›å…¥åç«¯ç›®å½•
cd /opt/warehouse-management/backend

# åˆ›å»º .env æ–‡ä»¶
nano .env
# æˆ–ä½¿ç”¨ vi .env
```

åœ¨ `.env` æ–‡ä»¶ä¸­è¾“å…¥ï¼š
```
PORT=3000
JWT_SECRET=ä½ çš„å¯†é’¥-è¯·ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²
DB_PATH=./warehouse.db
```

**é‡è¦**ï¼š`JWT_SECRET` è¯·ä¿®æ”¹ä¸ºä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š
```
JWT_SECRET=warehouse-secret-2024-abc123xyz789
```

ä¿å­˜æ–‡ä»¶ï¼ˆnano: Ctrl+X, ç„¶å Y, ç„¶å Enterï¼‰

---

## ğŸš€ ç¬¬å…­æ­¥ï¼šä½¿ç”¨ PM2 ç®¡ç†è¿›ç¨‹

### å®‰è£… PM2
```bash
npm install -g pm2
```

### å¯åŠ¨åç«¯æœåŠ¡
```bash
cd /opt/warehouse-management/backend

# æ„å»ºåç«¯ï¼ˆå¦‚æœè¿˜æ²¡æ„å»ºï¼‰
npm run build

# ä½¿ç”¨ PM2 å¯åŠ¨
pm2 start dist/index.js --name warehouse-api

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

### å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆæ–¹å¼1ï¼šä½¿ç”¨ PM2ï¼‰
```bash
cd /opt/warehouse-management/frontend

# ä½¿ç”¨ PM2 å¯åŠ¨å‰ç«¯ï¼ˆä½¿ç”¨ serveï¼‰
npm install -g serve
pm2 serve dist 5173 --name warehouse-frontend --spa

# ä¿å­˜é…ç½®
pm2 save
```

### å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆæ–¹å¼2ï¼šä½¿ç”¨ Nginxï¼Œæ¨èï¼‰
è§ä¸‹é¢çš„ Nginx é…ç½®

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
pm2 list          # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
pm2 logs          # æŸ¥çœ‹æ—¥å¿—
pm2 restart all   # é‡å¯æ‰€æœ‰æœåŠ¡
pm2 stop all      # åœæ­¢æ‰€æœ‰æœåŠ¡
```

---

## ğŸŒ ç¬¬ä¸ƒæ­¥ï¼šé…ç½® Nginxï¼ˆæ¨èï¼‰

### å®‰è£… Nginx
```bash
# Ubuntu/Debian
sudo apt install nginx

# CentOS/RHEL
sudo yum install nginx
```

### é…ç½® Nginx
```bash
sudo nano /etc/nginx/sites-available/warehouse
# CentOS ä½¿ç”¨: sudo nano /etc/nginx/conf.d/warehouse.conf
```

è¾“å…¥ä»¥ä¸‹é…ç½®ï¼š
```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸåæˆ–æœåŠ¡å™¨IP;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /opt/warehouse-management/frontend/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    # åç«¯ API ä»£ç†
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### å¯ç”¨é…ç½®
```bash
# Ubuntu/Debian
sudo ln -s /etc/nginx/sites-available/warehouse /etc/nginx/sites-enabled/
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx

# CentOS/RHEL
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx
```

---

## ğŸ”¥ ç¬¬å…«æ­¥ï¼šé…ç½®é˜²ç«å¢™

### Ubuntu/Debian (UFW)
```bash
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPSï¼ˆå¦‚æœä½¿ç”¨SSLï¼‰
sudo ufw enable
```

### CentOS/RHEL (firewalld)
```bash
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

---

## ğŸ”’ ç¬¬ä¹æ­¥ï¼šé…ç½® SSL è¯ä¹¦ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰

### ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦

```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx
# CentOS: sudo yum install certbot python3-certbot-nginx

# è·å–è¯ä¹¦ï¼ˆæ›¿æ¢ä¸ºä½ çš„åŸŸåï¼‰
sudo certbot --nginx -d ä½ çš„åŸŸå.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

---

## âœ… ç¬¬åæ­¥ï¼šéªŒè¯éƒ¨ç½²

1. **æ£€æŸ¥åç«¯æœåŠ¡**
   ```bash
   curl http://localhost:3000/api/health
   ```
   åº”è¯¥è¿”å›ï¼š`{"status":"ok","message":"ä»“åº“ç®¡ç†ç³»ç»ŸAPIè¿è¡Œæ­£å¸¸"}`

2. **æ£€æŸ¥å‰ç«¯**
   åœ¨æµè§ˆå™¨è®¿é—®ï¼š`http://ä½ çš„æœåŠ¡å™¨IP` æˆ– `http://ä½ çš„åŸŸå`

3. **æµ‹è¯•ç™»å½•**
   - ç”¨æˆ·åï¼š`admin`
   - å¯†ç ï¼š`admin123`

---

## ğŸ“ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### PM2 å‘½ä»¤
```bash
pm2 list                    # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
pm2 logs warehouse-api     # æŸ¥çœ‹åç«¯æ—¥å¿—
pm2 logs warehouse-frontend # æŸ¥çœ‹å‰ç«¯æ—¥å¿—
pm2 restart warehouse-api  # é‡å¯åç«¯
pm2 stop warehouse-api      # åœæ­¢åç«¯
pm2 delete warehouse-api   # åˆ é™¤è¿›ç¨‹
pm2 monit                   # ç›‘æ§é¢æ¿
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# PM2 æ—¥å¿—
pm2 logs

# Nginx æ—¥å¿—
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log

# ç³»ç»Ÿæ—¥å¿—
journalctl -u nginx -f
```

### æ›´æ–°ä»£ç 
```bash
cd /opt/warehouse-management

# å¦‚æœä½¿ç”¨ Git
git pull

# é‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœ‰æ–°ä¾èµ–ï¼‰
cd backend && npm install --production
cd ../frontend && npm install && npm run build

# é‡å¯æœåŠ¡
pm2 restart warehouse-api
sudo systemctl restart nginx
```

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tulpn | grep :3000
sudo lsof -i :3000

# æ€æ­»è¿›ç¨‹
sudo kill -9 PID
```

### 2. æƒé™é—®é¢˜
```bash
# ç¡®ä¿æ–‡ä»¶æƒé™æ­£ç¡®
sudo chown -R $USER:$USER /opt/warehouse-management
chmod -R 755 /opt/warehouse-management
```

### 3. æ•°æ®åº“è·¯å¾„é—®é¢˜
ç¡®ä¿æ•°æ®åº“æ–‡ä»¶è·¯å¾„å¯å†™ï¼š
```bash
chmod 666 /opt/warehouse-management/backend/warehouse.db
```

### 4. PM2 æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
pm2 logs warehouse-api --lines 50

# æ‰‹åŠ¨æµ‹è¯•
cd /opt/warehouse-management/backend
node dist/index.js
```

### 5. Nginx 502 é”™è¯¯
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`pm2 list`
- æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®ï¼š`curl http://localhost:3000/api/health`
- æ£€æŸ¥ Nginx é…ç½®ï¼š`sudo nginx -t`

---

## ğŸ”„ è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº† `deploy.sh` è„šæœ¬ï¼Œå¯ä»¥ä¸€é”®éƒ¨ç½²ï¼

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ä½¿ç”¨ MySQL/PostgreSQL æ›¿ä»£ SQLite**ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
2. **å¯ç”¨ Gzip å‹ç¼©**ï¼ˆåœ¨ Nginx é…ç½®ä¸­ï¼‰
3. **ä½¿ç”¨ CDN** åŠ é€Ÿé™æ€èµ„æº
4. **é…ç½® Redis** ç¼“å­˜çƒ­ç‚¹æ•°æ®
5. **å®šæœŸå¤‡ä»½æ•°æ®åº“**

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

ç°åœ¨ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ç³»ç»Ÿï¼š
- ç›´æ¥è®¿é—®ï¼š`http://ä½ çš„æœåŠ¡å™¨IP`
- åŸŸåè®¿é—®ï¼š`http://ä½ çš„åŸŸå.com`

é»˜è®¤ç™»å½•è´¦å·ï¼š`admin` / `admin123`

**é‡è¦æé†’**ï¼š
1. âœ… é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
2. âœ… å®šæœŸå¤‡ä»½æ•°æ®åº“æ–‡ä»¶
3. âœ… å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œä¾èµ–åŒ…
4. âœ… é…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼‰

ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€

